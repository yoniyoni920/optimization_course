/* fibos1.c */

#include <stdio.h>
#include <math.h>

void compute_fibo_number( double n, 
double *fn2_ptr, double *fn1_ptr, double *fn_ptr )
{
  unsigned  int i;
  double fibo0, fibo1, fibo2;

  fibo0 =  fibo1 = 1.0;
  for (i=2; i < n; i++)
  {
   fibo2 = fibo0 + fibo1;
   fibo0 = fibo1;
   fibo1 = fibo2;
  } // for

   fibo2 = fibo0 + fibo1;
  *fn_ptr = fibo2;
  *fn1_ptr = fibo1;
  *fn2_ptr = fibo0;
}/* compute_fibo_numbers */ 


void fibo_search( double (*fp)( double), 
          double a,  double b, double desired_eps,
          double *aptr,  double *bptr)
{

  double x1, fx1, x2, fx2, fxs;
  double last, delta;
  double fn, fn1, fn2, fi;
  double diff;
  int n;
 int i;
 
 diff = b-a;
 n = (log(diff)-log(desired_eps))/log(1.618);
 n =  n + 3;

 printf("n = %d\n", n);

 compute_fibo_number(n,&fn2, &fn1, &fn );

 x1 = a+diff*fn2/fn;
 x2 = a+diff*fn1/fn;
 fx1 = (*fp)(x1);
 fx2 = (*fp)(x2);
 last = x1;

for(i = n-3; i > 0; i--)
{ 
 printf("a = %lf, x1 = %lf, x2 = %lf, b = %lf\n", a, x1, x2, b);
 printf("fx1 = %lf, fx2= %lf, last = %lf\n", fx1, fx2, last);
 fi = fn1 - fn2;
 printf("fn = %10.2lf, fn1 = %10.2lf, fn2 = %10.2lf, fi = %10.2lf\n", 
   fn, fn1, fn2, fi);

 if (fx1 > fx2)
 {
   a = x1;
   x1 = x2;
   fx1 = fx2;
   x2 = b - diff*fi/fn; 
   fx2 = (*fp)(x2);
   last = x2;
 } /* if */
 else 
 {
   b = x2;
   x2 = x1;
   fx2 = fx1;
   x1 = a + diff*fi/fn; 
   fx1 = (*fp)(x1);
   last = x1;
 }/* else */

 fn1 = fn2;
 fn2 = fi;
} /* for */

/* last comparison */

delta = (b-a)/64.0;

if (last == x1)
{
   fxs = (*fp)(x1+delta);
   if (fxs < fx1)
   {
     *aptr = x1;
     *bptr  = b;
   } /* if */
   else
   {
    *aptr = a;
    *bptr  = x1;
   } /* else */
   
} /* if */
else /* last == x2 */
{
   fxs = (*fp)(x2-delta);
   if (fxs < fx2)
   {
     *aptr = a;
     *bptr  = x2;
   } /* if */
   else
   {
    *aptr = x2;
    *bptr  = b;
   } /* else */ 
} /* else */


} /* fibo_search */


 double f( double x)
{
  double temp;

  temp = x - 5.0;
  temp = temp*temp*temp*temp;
  
   return temp;
} /* f */


int main()
{
 
  double x, a, b, desired_eps;

 desired_eps = 0.00001;
 fibo_search(f, 1.0, 8.0, desired_eps, &a, &b);

 printf("Min solution within %lf is between  = %lf to %lf\n", 
           desired_eps, a, b);
 printf("Min value estimate  = %lf\n", f((a+b)/2.0));

} /* main */

/* golden6.c */
#include <stdio.h>
#include <math.h>


double golden(double (*fp)(double), double a, double b, double eps)
{
 double x1, fx1,  fb, x2, fx2;
 double phi = 1.618;
 double phi1 = 2.618;

 x1 = a + (b-a)/phi1;
 fx1 = (*fp)(x1);
 x2 = a + (b-a)/phi;
 fx2 = (*fp)(x2);


do {

 if (fx1 > fx2)
 {
   a = x1;
   x1 = x2;
   fx1 = fx2;
   x2 = a + (b-a)/phi;
   fx2 = (*fp)(x2);
 }
 else 
  {
   b = x2;
   x2 = x1;
   fx2 = fx1;
   x1 = a + (b-a)/phi1;
   fx1 = (*fp)(x1);
  } /* else */  

} while ( (b - a) > eps);

 return ( (a+b)/2);
} /* golden */


 double f( double x)
{
  double temp;

  temp = (x - 5.0)*(x - 5.0)*(x - 3.7)*(x - 3.7);
  
   return temp;
} /* f */



int main()
{
 
 double x;

 x = golden(f,  1.0, 6.0, 0.0001);

 printf("Min solution x = %lf, min value = %lf\n", x, f(x));

} /* main */